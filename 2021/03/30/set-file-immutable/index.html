<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/zeebe-chaos/rss.xml" title="Zeebe Chaos Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zeebe-chaos/atom.xml" title="Zeebe Chaos Blog Atom Feed"><title data-react-helmet="true">Set file immutable | Zeebe Chaos</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://zeebe-io.github.io/zeebe-chaos/2021/03/30/set-file-immutable"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Set file immutable | Zeebe Chaos"><meta data-react-helmet="true" name="description" content="This chaos day was a bit different. Actually I wanted to experiment again with camunda cloud and verify that our high load chaos experiments are now working with the newest cluster plans, see zeebe-cluster-testbench#135."><meta data-react-helmet="true" property="og:description" content="This chaos day was a bit different. Actually I wanted to experiment again with camunda cloud and verify that our high load chaos experiments are now working with the newest cluster plans, see zeebe-cluster-testbench#135."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-03-30T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/zelldon"><link data-react-helmet="true" rel="shortcut icon" href="/zeebe-chaos/img/zeebe-logo.png"><link data-react-helmet="true" rel="canonical" href="https://zeebe-io.github.io/zeebe-chaos/2021/03/30/set-file-immutable"><link data-react-helmet="true" rel="alternate" href="https://zeebe-io.github.io/zeebe-chaos/2021/03/30/set-file-immutable" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zeebe-io.github.io/zeebe-chaos/2021/03/30/set-file-immutable" hreflang="x-default"><link rel="stylesheet" href="/zeebe-chaos/assets/css/styles.4cd2f5b2.css">
<link rel="preload" href="/zeebe-chaos/assets/js/runtime~main.7519e902.js" as="script">
<link rel="preload" href="/zeebe-chaos/assets/js/main.5f196896.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zeebe-chaos/"><img src="/zeebe-chaos/img/zeebe-logo.png" alt="Zeebe" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/zeebe-chaos/img/zeebe-logo.png" alt="Zeebe" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Zeebe Chaos</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zeebe-chaos/">Chaos Summaries</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/zeebe-io/zeebe-chaos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">All posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2022/02/15/Standalone-Gateway-in-CCSaaS">Standalone Gateway in CCSaaS</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2022/02/01/High-Snapshot-Frequency">High Snapshot Frequency</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2022/01/19/big-variables">Handling of Big Variables</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/11/24/Worker-count-should-not-impact-performance">Worker count should not impact performance</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/11/11/Not-produce-duplicate-Keys">Not produce duplicate Keys</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/10/29/Throughput-on-big-state">Throughput on big state</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/10/05/recovery-time">Recovery (Fail Over) time</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/09/23/Old-Clients">Old-Clients</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/07/06/Slow-Network">Slow Network</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/06/08/Full-Disk">Full Disk Recovery</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/05/25/Reset-Clock">Time travel Experiment</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/04/29/Corrupted-Snapshot">Corrupted Snapshot Experiment Investigation</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/04/03/bpmn-meets-chaos-engineering">BPMN meets Chaos Engineering</a></li><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/zeebe-chaos/2021/03/30/set-file-immutable">Set file immutable</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/03/23/camunda-cloud-network-partition">Camunda Cloud network partition</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/03/09/cont-workflow-instance">Fault-tolerant processing of process instances</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/02/23/automate-deployments-dist">Automating Deployment Distribution Chaos Experiment</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/01/26/deployments">Deployment Distribution</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/01/19/network-partition">Network partitions</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2021/01/07/disconnect-leader-and-follower">Disconnect Leader and one Follower</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/11/24/message-correlation-after-failover">Message Correlation after Failover</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/11/11/job-timeouts">Many Job Timeouts</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/11/03/investigate-failing-tests">Investigate failing Chaos Tests</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/10/20/non-graceful-shutdown">Non-graceful Shutdown Broker</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/10/27/standalone-gw-memory">Gateway memory consumption</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/10/13/multiple-leader-changes">Multiple Leader Changes</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/10/06/toxi-proxy">Play around with ToxiProxy</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/08/20/experiment-with-camunda-cloud">Experiment with Camunda Cloud</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/08/06/low-load">Experiment with Low Load</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/07/30/experiment-without-exporters">Experiment without Exporters</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/07/16/big-multi-instance">Big Multi Instance</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/07/09/timer-and-huge-variables">Experiment with Timers and Huge Variables</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/07/02/extract-k8-resources">Extract K8 resources from namespace</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/06/25/gateway-network-partition">Gateway Network Partition</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/06/18/correlate-message-after-failover">Correlate Message after failover</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/06/11/high-cpu-gateway">High CPU load on Standalone Gateway</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/zeebe-chaos/2020/06/04/first-chaos-day">First Chaos Day!</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Set file immutable</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-03-30T00:00:00.000Z" itemprop="datePublished">March 30, 2021</time> Â· 7 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/zelldon" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/zelldon.png" alt="Christopher Zell"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/zelldon" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Christopher Zell</span></a></div><small class="avatar__subtitle" itemprop="description">Chaos Engineer @ Zeebe</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>This chaos day was a bit different. Actually I wanted to experiment again with camunda cloud and verify that our high load chaos experiments are now working with the newest cluster plans, see <a href="https://github.com/zeebe-io/zeebe-cluster-testbench/issues/135" target="_blank" rel="noopener noreferrer">zeebe-cluster-testbench#135</a>.
Unfortunately I found out that our test chaos cluster was in a way broken, that we were not able to create new clusters. Luckily this was fixed at the end of the day, thanks to @immi :) </p><p>Because of these circumstances I thought about different things to experiment with, and I remembered that in the <a href="/zeebe-chaos/2021/03/23/camunda-cloud-network-partition">last chaos day</a> we worked with patching running deployments, in order to add more capabilities.
This allowed us to create ip routes and experiment with the zeebe deployment distribution. During this I have read the <a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank" rel="noopener noreferrer">capabilities list of linux</a>, and found out that we can mark files as immutable, which might be interesting for a chaos experiment.</p><p>In this chaos day I planned to find out how marking a file immutable affects our brokers and I made the hypothesis that: <em>If a leader has a write error, which is not recoverable, it will step down and another leader should take over.</em> I put this in our hypothesis backlog (<a href="https://github.com/zeebe-io/zeebe-chaos/issues/52" target="_blank" rel="noopener noreferrer">zeebe-chaos#52</a>). </p><p>In order to really run this kind of experiment I need to find out whether marking a file immutable will cause any problems and if not how I can cause write errors such that affects the broker.
Unfortunately it turned out that immutable files will not cause issues on already opened file channels, but I found some other bugs/issues, which you can read below.</p><p>In the next chaos days I will search for a way to cause write errors proactively, so we can verify that our system can handle such issues.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="immutable-file"></a>Immutable File<a class="hash-link" href="#immutable-file" title="Direct link to heading">#</a></h3><p>In order to <a href="https://delightlylinux.wordpress.com/2012/12/11/file-immutable-attribute/" target="_blank" rel="noopener noreferrer">mark a file as immutable</a> we can use the command <code>chattr +i</code>. For that we need a specific capability called <code>LINUX_IMMUTABLE</code>. Since we were at this time not able to create new clusters I tested it with the helm charts, where it is anyway easier to give us these capabilities.</p><p>We just need to add in our <em>values</em> files the following:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">podSecurityContext:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  capabilities:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        add: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;LINUX_IMMUTABLE&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Since we want to experiment with leaders I need to get the current topology from the gateway, here I found an issue on our latest zbctl build and the human output (<a href="https://github.com/camunda-cloud/zeebe/issues/6692" target="_blank" rel="noopener noreferrer">camunda-cloud/zeebe#6692</a>). This is already fixed, thanks to <a href="https://github.com/MiguelPires" target="_blank" rel="noopener noreferrer">Miguel</a> ðŸš€!</p><p>After finding the correct leader we can execute on the corresponding broker/pod following commands to mark a file as immutable.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">zell ns:zell-chaos</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">$ k </span><span class="token builtin class-name">exec</span><span class="token plain"> -it zell-chaos-zeebe-1 -- </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># opens an interactive shell on zell-chaos-zeebe-1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">root@zell-chaos-zeebe-1</span><span class="token comment" style="color:#999988;font-style:italic"># cd data/raft-partition/partitions/1/</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">root@zell-chaos-zeebe-1</span><span class="token comment" style="color:#999988;font-style:italic"># chattr +i raft-partition-partition-1-1.log # marks the log file immutable</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">root@zell-chaos-zeebe-1</span><span class="token comment" style="color:#999988;font-style:italic"># lsattr raft-partition-partition-1-1.log</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">----i---------e---- raft-partition-partition-1-1.log</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>With the last command <code>lsattr</code> we print out the file attributes, where we see that the immutable flag is set (the <code>i</code> in the output).
After setting the log file to immutable nothing really happens. I checked again the manual page and read that this not affects already created file channels.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">CHATTR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                           General Commands Manual                          CHATTR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME</span></span><span class="token-line" style="color:#393A34"><span class="token plain">       chattr - change </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> attributes on a Linux </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> system</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      i      A  </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> with the </span><span class="token string" style="color:#e3116c">&#x27;i&#x27;</span><span class="token plain"> attribute cannot be modified: it cannot be deleted or renamed, no </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> can be created to this file, </span><span class="token function" style="color:#d73a49">most</span><span class="token plain"> of the </span><span class="token function" style="color:#d73a49">file</span><span class="token string" style="color:#e3116c">&#x27;s metadata can not be modified, and the</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">              file can not be opened in write mode.  Only the superuser or a process possessing the CAP_LINUX_IMMUTABLE capability can set or clear this attribute.</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      ...</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      BUGS AND LIMITATIONS</span></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">       The &#x27;</span><span class="token plain">c</span><span class="token string" style="color:#e3116c">&#x27;, &#x27;</span><span class="token plain">s</span><span class="token string" style="color:#e3116c">&#x27;,  and &#x27;</span><span class="token plain">u</span><span class="token string" style="color:#e3116c">&#x27; attributes are not honored by the ext2, ext3, and ext4 filesystems as implemented in the current mainline Linux kernels.  Setting &#x27;</span><span class="token plain">a</span><span class="token string" style="color:#e3116c">&#x27; and &#x27;</span><span class="token plain">i&#x27; attributes will not</span></span><span class="token-line" style="color:#393A34"><span class="token plain">       affect the ability to </span><span class="token function" style="color:#d73a49">write</span><span class="token plain"> to already existing </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> descriptors.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>So we actually are not able to use it to cause any write errors on a running leader, but interesting was what happened later when the pod was restarted. The pod was not able to restart, since the log was still immutable. We can see the following bootstrap sequence and the related errors:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.433467Z Found segment: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">raft-partition-partition-2-1.log</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.499079Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - Transitioning to FOLLOWER </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.500847Z RaftPartitionServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - Starting server </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> partition PartitionId</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">group</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">raft-partition</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.506876Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - Server </span><span class="token function" style="color:#d73a49">join</span><span class="token plain"> completed. Waiting </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> the server to be READY </span></span><span class="token-line" style="color:#393A34"><span class="token plain">E </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.508400Z Bootstrap Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">6</span><span class="token plain">/13</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: cluster services failed with unexpected exception. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.523239Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: subscription api </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.525497Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: subscription api closed </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> ms </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.526484Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: </span><span class="token builtin class-name">command</span><span class="token plain"> api handler </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.528108Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: </span><span class="token builtin class-name">command</span><span class="token plain"> api handler closed </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> ms </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:02.528740Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: </span><span class="token builtin class-name">command</span><span class="token plain"> api transport </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:03.519309Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - Found leader </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:03.521376Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - Setting firstCommitIndex to </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">. RaftServer is ready only after it has committed events upto this index </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:03.522206Z RaftPartitionServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - Successfully started server </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> partition PartitionId</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">group</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">raft-partition</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> 1171ms </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.553825Z Stopped </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.555166Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: </span><span class="token builtin class-name">command</span><span class="token plain"> api transport closed </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2026</span><span class="token plain"> ms </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.556177Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: membership and replication protocol </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.558282Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - Transitioning to INACTIVE </span></span><span class="token-line" style="color:#393A34"><span class="token plain">E </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.558408Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: membership and replication protocol failed to close. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.560776Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: actor scheduler </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.561558Z Closing actor thread ground </span><span class="token string" style="color:#e3116c">&#x27;Broker-1-zb-fs-workers&#x27;</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.563600Z Closing segment: JournalSegment</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">version</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">index</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.563881Z Closing actor thread ground </span><span class="token string" style="color:#e3116c">&#x27;Broker-1-zb-fs-workers&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> closed successfully </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.564448Z Closing actor thread ground </span><span class="token string" style="color:#e3116c">&#x27;Broker-1-zb-actors&#x27;</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.566157Z Closing actor thread ground </span><span class="token string" style="color:#e3116c">&#x27;Broker-1-zb-actors&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> closed successfully </span></span><span class="token-line" style="color:#393A34"><span class="token plain">D </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.567716Z Closing Broker-1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token plain">/5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: actor scheduler closed </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> ms </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.568366Z Closing Broker-1 succeeded. Closed </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> steps </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2045</span><span class="token plain"> ms. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">E </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.568908Z Failed to start broker </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.574482Z </span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Error starting ApplicationContext. To display the conditions report re-run your application with </span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token plain"> enabled. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">E </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.595919Z Application run failed </span></span><span class="token-line" style="color:#393A34"><span class="token plain">I </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:04.627321Z Shutting down ExecutorService </span><span class="token string" style="color:#e3116c">&#x27;applicationTaskExecutor&#x27;</span><span class="token plain"> </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The following exception occurred on opening the log:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">java.util.concurrent.CompletionException: io.zeebe.journal.JournalException: java.nio.file.FileSystemException: /usr/local/zeebe/data/raft-partition/partitions/1/raft-partition-partition-1-1.log: Operation not permitted</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    at java.util.concurrent.CompletableFuture.encodeThrowable(Unknown Source) ~[?:?]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    at java.util.concurrent.CompletableFuture.completeThrowable(Unknown Source) ~[?:?]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    at java.lang.Thread.run(Unknown Source) ~[?:?]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Caused by: io.zeebe.journal.JournalException: java.nio.file.FileSystemException: /usr/local/zeebe/data/raft-partition/partitions/1/raft-partition-partition-1-1.log: Operation not permitted</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    at io.zeebe.journal.file.SegmentedJournal.openChannel(SegmentedJournal.java:468) ~[zeebe-journal-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    at io.zeebe.journal.file.SegmentedJournal.loadSegments(SegmentedJournal.java:490) ~[zeebe-journal-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>After this exception on bootstrap the broker tries to close itself, and we see an error on closing a step <code>2021-03-30 11:11:04.558 CEST Closing Broker-1 [4/5]: membership and replication protocol failed to close.</code> This seems to be caused by a NPE.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">java.lang.NullPointerException: null</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    at io.atomix.raft.partition.impl.RaftPartitionServer.stop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RaftPartitionServer.java:141</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ~</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">atomix-cluster-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    at io.atomix.raft.partition.RaftPartition.closeServer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RaftPartition.java:165</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ~</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">atomix-cluster-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    at io.atomix.raft.partition.RaftPartition.close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RaftPartition.java:155</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ~</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">atomix-cluster-1.0.0-SNAPSHOT.jar:1.0.0-SNAPSHOT</span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The problem now here is that the broker never comes back. It is not restarted, which is a bit confusing. Furthermore it hasn&#x27;t retried on opening, which is also unexpected, since it might be a temporary exception. </p><p>We can see in stackdriver that the new leader is not able to connect, which is expected. But we also see that the other Broker never comes back which is unexpected!</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">W </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:05.006825Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - AppendRequest</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">term</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">leader</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogTerm</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">entries</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">commitIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> failed: java.util.concurrent.CompletionException: io.atomix.cluster.messaging.MessagingException</span><span class="token variable" style="color:#36acaa">$NoRemoteHandler</span><span class="token builtin class-name">:</span><span class="token plain"> No remote message handler registered </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> this message </span></span><span class="token-line" style="color:#393A34"><span class="token plain">W </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:05.256830Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - AppendRequest</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">term</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">leader</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogTerm</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">entries</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">commitIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> failed: java.util.concurrent.CompletionException: io.atomix.cluster.messaging.MessagingException</span><span class="token variable" style="color:#36acaa">$NoRemoteHandler</span><span class="token builtin class-name">:</span><span class="token plain"> No remote message handler registered </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> this message </span></span><span class="token-line" style="color:#393A34"><span class="token plain">W </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:08.450683Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - AppendRequest</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">term</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">leader</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogTerm</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">entries</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">commitIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> failed: java.util.concurrent.CompletionException: io.atomix.cluster.messaging.MessagingException</span><span class="token variable" style="color:#36acaa">$NoRemoteHandler</span><span class="token builtin class-name">:</span><span class="token plain"> No remote message handler registered </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> this message </span></span><span class="token-line" style="color:#393A34"><span class="token plain">W </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:12.897492Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - AppendRequest</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">term</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">leader</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogTerm</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">entries</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">commitIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> failed: java.util.concurrent.CompletionException: io.atomix.cluster.messaging.MessagingException</span><span class="token variable" style="color:#36acaa">$NoRemoteHandler</span><span class="token builtin class-name">:</span><span class="token plain"> No remote message handler registered </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> this message </span></span><span class="token-line" style="color:#393A34"><span class="token plain">W </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-30T09:11:25.950363Z RaftServer</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">raft-partition-partition-3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> - AppendRequest</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">term</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">leader</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">prevLogTerm</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">entries</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">commitIndex</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> failed: java.util.concurrent.CompletionException: io.atomix.cluster.messaging.MessagingException</span><span class="token variable" style="color:#36acaa">$NoRemoteHandler</span><span class="token builtin class-name">:</span><span class="token plain"> No remote message handler registered </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> this message</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We need to investigate this issue <a href="https://github.com/camunda-cloud/zeebe/issues/6702" target="_blank" rel="noopener noreferrer">camunda-cloud/zeebe#6702</a> further, and I need to find out how we can cause write errors proactively.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="found-bugs"></a>Found Bugs<a class="hash-link" href="#found-bugs" title="Direct link to heading">#</a></h4><ul><li>Int Console was not able to create new clusters in ultrachaos </li><li>Zbctl human output looks broken <a href="https://github.com/camunda-cloud/zeebe/issues/6692" target="_blank" rel="noopener noreferrer">#6692</a></li><li>Broker is not correctly shutdown <a href="https://github.com/camunda-cloud/zeebe/issues/6702" target="_blank" rel="noopener noreferrer">#6702</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zeebe-chaos/2021/04/03/bpmn-meets-chaos-engineering"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« BPMN meets Chaos Engineering</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zeebe-chaos/2021/03/23/camunda-cloud-network-partition"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Camunda Cloud network partition Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#immutable-file" class="table-of-contents__link">Immutable File</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/zeebe" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://forum.camunda.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/Camunda" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/zeebe-io/zeebe-chaos/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Zeebe Chaos. Built with Docusaurus.</div></div></div></footer></div>
<script src="/zeebe-chaos/assets/js/runtime~main.7519e902.js"></script>
<script src="/zeebe-chaos/assets/js/main.5f196896.js"></script>
</body>
</html>